{% extends 'seeker_base.html' %}

{% block content %}
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />

<!-- JS -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

<div class="container mt-5">
    <h2>Seeker Profile</h2>
    
    {% if messages %}
    <div class="messages">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        {% endfor %}
    </div>
    {% endif %}
    
    <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}

        <!-- First Name -->
        <div class="mb-3">
            <label for="first_name" class="form-label">First Name</label>
            <input type="text" class="form-control" id="first_name" name="first_name"  required
                   value="{% if profile %}{{ profile.first_name }}{% else %}{{ user.first_name }}{% endif %}" 
                   placeholder="Enter your first name">
        </div>

        <!-- Last Name -->
        <div class="mb-3">
            <label for="last_name" class="form-label">Last Name</label>
            <input type="text" class="form-control" id="last_name" name="last_name" 
                   value="{% if profile %}{{ profile.last_name }}{% else %}{{ user.last_name }}{% endif %}" 
                   placeholder="Enter your last name">
        </div>

        <!-- Email -->
        <div class="mb-3">
            <label for="email" class="form-label">Email</label>
            <input type="email" class="form-control" id="email" name="email" 
                   value="{% if profile %}{{ profile.email }}{% else %}{{ user.email }}{% endif %}" 
                   placeholder="Enter your email">
        </div>

        <!-- Phone Number -->
        <div class="mb-3">
            <label for="phone_number" class="form-label">Phone Number</label>
            <input type="text" class="form-control" id="phone_number" name="phone_number" 
                   value="{% if profile %}{{ profile.phone_number }}{% endif %}" 
                   placeholder="Enter your phone number">
        </div>
        <div class="mb-3">
    <label for="location" class="form-label">Location</label>
    <select class="form-select" id="location" name="location">
        <option value="">-- Select City --</option>
        {% for city in cities %}
            <option value="{{ city }}" {% if profile.location == city %}selected{% endif %}>
                {{ city }}
            </option>
        {% endfor %}
    </select>
</div>

        <!-- Skills: multiple selection with search -->
        <div class="mb-3">
            <label for="skills" class="form-label">Skills</label>
            <select class="form-select" id="skills" name="skills" multiple="multiple">
                {% for skill in skills %}
                    <option value="{{ skill.id }}" 
                    {% if profile and skill in profile.skills.all %}selected{% endif %}>
                    {{ skill.name }}</option>
                {% endfor %}
            </select>
            <small class="form-text text-muted">Search and select multiple skills.</small>
        </div>

        <!-- Experience -->
        

        <!-- Resume Upload -->
        <div class="mb-3">
            <label for="resume" class="form-label">Upload Resume</label>
            <input type="file" class="form-control" id="resume" name="resume">
            {% if profile and profile.resume %}
            <div class="mt-2">
                <small class="text-muted">Current resume: <a href="{{ profile.resume.url }}" target="_blank">View Resume</a></small>
            </div>
            {% endif %}
        </div>

        <button type="submit" class="btn btn-primary">Save Profile</button>
    </form>
</div>

<script>
    $(document).ready(function() {
        $('#skills').select2({
            placeholder: "Select your skills",
            allowClear: true
        });
    });
</script>
{% endblock %}